{"version":3,"sources":["components/knnresults.js","components/essentials.js"],"names":["medFilter","feature","properties","priority","othersFilter","getDistance","p1","p2","phi1","Math","PI","phi2","dLambda","d","acos","sin","cos","Number","toFixed","KnnResults","userLocation","userState","useState","geoData","setGeoData","results","setResults","categories","setCategories","useEffectOnce","getJSON","useCallback","fetch","then","response","json","catch","error","console","log","useEffect","medKnn","restKnn","panKnn","Knn","layer","geoJSON","filter","nearestLayer","features","feat","state","includes","result","name","type","i","length","push","geometry","coordinates","desc","addr","phone","contact","icon","recordid","dist","reverse","j","k","map","reduce","acc","e","set","get","Map","forEach","value","key","categoryMeta","count","isSelected","className","style","animationDelay","Object","keys","categoryName","classnames","onClick","newIsSelected","produce","draft","toggleFilter","href","target","split","replace","EssentialsLoader","useMeasure","svgElement","width","Fragment","ref","speed","height","viewBox","position","x","y","rx","ry","Essentials","props","currentLocation","setCurrentLocation","currentAddress","setCurrentAddress","currentState","setCurrentState","getCurrentAddress","lat","lng","url","data","locality","principalSubdivision","err","src","alt","navigator","geolocation","getCurrentPosition","coords","latitude","longitude","size"],"mappings":"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","file":"static/js/Essentials.12fa09a0.chunk.js","sourcesContent":["import classnames from 'classnames';\nimport produce from 'immer';\nimport {layer} from 'leaflet';\nimport * as Knn from 'leaflet-knn';\nimport React, {useState, useEffect, useCallback} from 'react';\nimport {ExternalLink, Phone} from 'react-feather';\nimport {useEffectOnce} from 'react-use';\n\nfunction medFilter(feature) {\n  return feature.properties.priority;\n}\n\nfunction othersFilter(feature) {\n  return !feature.properties.priority;\n}\n\nfunction getDistance(p1, p2) {\n  // p1 and p2 => [lat1, long1], [lat2, long2]\n  const phi1 = (p1[0] * Math.PI) / 180;\n  const phi2 = (p2[0] * Math.PI) / 180;\n  const dLambda = ((p2[1] - p1[1]) * Math.PI) / 180;\n  const R = 6371e3;\n  const d =\n    Math.acos(\n      Math.sin(phi1) * Math.sin(phi2) +\n        Math.cos(phi1) * Math.cos(phi2) * Math.cos(dLambda)\n    ) * R;\n  return Number((d / 1000).toFixed(2));\n}\n\nfunction KnnResults({userLocation, userState}) {\n  const [geoData, setGeoData] = useState([]);\n  const [results, setResults] = useState();\n  const [categories, setCategories] = useState([]);\n\n  useEffectOnce(() => {\n    getJSON();\n  }, []);\n\n  const getJSON = useCallback(() => {\n    const url = 'https://api.covid19india.org/resources/geoResources.json';\n    fetch(url)\n      .then((response) => {\n        return response.json();\n      })\n      .then(setGeoData)\n      .catch((error) => {\n        console.log(error);\n      });\n  }, []);\n\n  useEffect(() => {\n    let medKnn;\n    let restKnn;\n    let panKnn;\n\n    const hK = 5; // K nearest hospitals/labs wrt user location\n    const rK = 100; // K nearest essentials wrt user location\n    const rad = 10 * 1000; // Max distance of the K points, in meters ; aim to be  ~(avg city radius)\n\n    if (userLocation) {\n      medKnn = new Knn(\n        layer.geoJSON(geoData, {filter: medFilter})\n      ).nearestLayer([userLocation[1], userLocation[0]], hK);\n      restKnn = new Knn(\n        layer.geoJSON(geoData, {filter: othersFilter})\n      ).nearestLayer([userLocation[1], userLocation[0]], rK, rad);\n      panKnn = geoData?.features?.filter(\n        (feat) =>\n          feat.properties.state === 'PAN India' ||\n          (feat.properties.state.includes('PAN') &&\n            feat.properties.state.includes(userState))\n      );\n    }\n\n    const result = {\n      name: 'NearestK-Essentials',\n      type: 'FeatureCollection',\n      features: [],\n    };\n\n    if (medKnn) {\n      let i = 0;\n      for (i = 0; i < medKnn.length; i++) {\n        result.features.push({\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: medKnn[i].layer.feature.geometry.coordinates,\n          },\n          properties: {\n            name: medKnn[i].layer.feature.properties.name,\n            desc: medKnn[i].layer.feature.properties.desc,\n            addr: medKnn[i].layer.feature.properties.addr,\n            phone: medKnn[i].layer.feature.properties.phone,\n            contact: medKnn[i].layer.feature.properties.contact,\n            icon: medKnn[i].layer.feature.properties.icon,\n            recordid: medKnn[i].layer.feature.properties.recordid,\n            dist: getDistance(\n              userLocation,\n              medKnn[i].layer.feature.geometry.coordinates.reverse()\n            ),\n          },\n        });\n      }\n    }\n\n    if (restKnn) {\n      let j = 0;\n      for (j = 0; j < restKnn.length; j++) {\n        result.features.push({\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: restKnn[j].layer.feature.geometry.coordinates,\n          },\n          properties: {\n            name: restKnn[j].layer.feature.properties.name,\n            desc: restKnn[j].layer.feature.properties.desc,\n            addr: restKnn[j].layer.feature.properties.addr,\n            phone: restKnn[j].layer.feature.properties.phone,\n            contact: restKnn[j].layer.feature.properties.contact,\n            icon: restKnn[j].layer.feature.properties.icon,\n            recordid: restKnn[j].layer.feature.properties.recordid,\n            dist: getDistance(\n              userLocation,\n              restKnn[j].layer.feature.geometry.coordinates.reverse()\n            ),\n          },\n        });\n      }\n    }\n\n    if (panKnn) {\n      let k = 0;\n      for (k = 0; k < panKnn.length; k++) {\n        result.features.push(panKnn[k]);\n      }\n    }\n\n    setResults(result);\n  }, [geoData, userLocation, userState]);\n\n  const toggleFilter = (categoryName, newIsSelected) => {\n    setCategories(\n      produce((draft) => {\n        draft[categoryName].isSelected = newIsSelected;\n      })\n    );\n  };\n\n  useEffect(() => {\n    const categories = {};\n    if (results) {\n      results.features\n        .map(function (feature) {\n          return feature?.properties?.icon;\n        })\n        .reduce((acc, e) => acc.set(e, (acc.get(e) || 0) + 1), new Map())\n        .forEach((value, key, map) => {\n          const categoryMeta = {count: value, isSelected: true};\n          categories[key] = categoryMeta;\n        });\n    }\n    setCategories(categories);\n  }, [results]);\n\n  if (results)\n    return (\n      <div className=\"results fadeInUp\" style={{animationDelay: '0.5s'}}>\n        <div className=\"labels\">\n          {Object.keys(categories).map((categoryName) => (\n            <div\n              key={categoryName}\n              className={classnames('label', {\n                'is-selected': categories[categoryName].isSelected,\n              })}\n              onClick={() =>\n                toggleFilter(categoryName, !categories[categoryName].isSelected)\n              }\n            >\n              {categoryName}\n              <div className=\"count\">{categories[categoryName].count}</div>\n            </div>\n          ))}\n        </div>\n\n        {results?.features\n          .filter((feature) => {\n            return (\n              Object.keys(categories)\n                .filter(\n                  (categoryName) => categories[categoryName].isSelected === true\n                )\n                .includes(feature.properties.icon) && feature.properties.dist\n            );\n          })\n          .map((result, i) => (\n            <div\n              key={result.properties.recordid ? result.properties.recordid : i}\n              className=\"essential-result\"\n            >\n              <div className=\"result-top\">\n                <div className=\"result-top-left\">\n                  <div className=\"result-name\">{result.properties.name}</div>\n                  <div className=\"result-location\">\n                    {result.properties.addr}\n                  </div>\n                  {result.properties.dist && (\n                    <div className=\"result-distance\">\n                      {result.properties.dist + ' km away'}\n                    </div>\n                  )}\n                </div>\n                <a\n                  className=\"result-category\"\n                  href={result.properties.contact}\n                  target=\"_noblank\"\n                >\n                  <span>{result.properties.icon}</span>\n                  <ExternalLink />\n                </a>\n              </div>\n              <div className=\"result-description\">{result.properties.desc}</div>\n              <div className=\"result-contacts\">\n                {result.properties.phone.split('\\n').map((contact) => (\n                  <div key={contact} className=\"result-contact\">\n                    <Phone />\n                    <a href={`tel:${contact}`}>{contact.replace(',', '')}</a>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n\n        <div>\n          <h3 className=\"pan-divider\">{`Throughout ${userState} and India`}</h3>\n        </div>\n\n        {results?.features\n          .filter((feature) => {\n            return (\n              Object.keys(categories)\n                .filter(\n                  (categoryName) => categories[categoryName].isSelected === true\n                )\n                .includes(feature.properties.icon) && !feature.properties.dist\n            );\n          })\n          .map((result, i) => (\n            <div\n              key={result.properties.recordid ? result.properties.recordid : i}\n              className=\"essential-result\"\n            >\n              <div className=\"result-top\">\n                <div className=\"result-top-left\">\n                  <div className=\"result-name\">{result.properties.name}</div>\n                  <div className=\"result-location\">\n                    {result.properties.addr}\n                  </div>\n                  {result.properties.dist && (\n                    <div className=\"result-distance\">\n                      {result.properties.dist + ' km away'}\n                    </div>\n                  )}\n                </div>\n                <a\n                  className=\"result-category\"\n                  href={result.properties.contact}\n                  target=\"_noblank\"\n                >\n                  <span>{result.properties.icon}</span>\n                  <ExternalLink />\n                </a>\n              </div>\n              <div className=\"result-description\">{result.properties.desc}</div>\n              <div className=\"result-contacts\">\n                {result.properties.phone.split('\\n').map((contact) => (\n                  <div key={contact} className=\"result-contact\">\n                    <Phone />\n                    <a href={`tel:${contact}`}>{contact.replace(',', '')}</a>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n      </div>\n    );\n  else return null;\n}\n\nexport default KnnResults;\n","import KnnResults from './knnresults';\n\nimport React, {useState, useEffect} from 'react';\nimport ContentLoader from 'react-content-loader';\nimport * as Icon from 'react-feather';\nimport {useMeasure} from 'react-use';\n\nfunction EssentialsLoader() {\n  const [svgElement, {width}] = useMeasure();\n\n  useEffect(() => {}, [width]);\n\n  return (\n    <React.Fragment>\n      <span ref={svgElement} style={{width: '100%'}} />\n      {width && (\n        <ContentLoader\n          speed={1.5}\n          width={width}\n          height={325}\n          viewBox={`0 0 ${width} 325`}\n          position=\"absolute\"\n          className=\"fadeInUp\"\n        >\n          <rect\n            x={width / 2 - 60}\n            y=\"10\"\n            rx=\"5\"\n            ry=\"5\"\n            width=\"120\"\n            height=\"32\"\n          />\n          <rect\n            x={width / 2 + 70}\n            y=\"18\"\n            rx=\"100\"\n            ry=\"100\"\n            width=\"15\"\n            height=\"15\"\n          />\n          <rect x=\"10\" y=\"80\" rx=\"5\" ry=\"5\" width=\"85\" height=\"32\" />\n          <rect x=\"100\" y=\"80\" rx=\"5\" ry=\"5\" width=\"65\" height=\"32\" />\n          <rect x=\"10\" y=\"130\" rx=\"5\" ry=\"5\" width={width - 20} height=\"172\" />\n        </ContentLoader>\n      )}\n    </React.Fragment>\n  );\n}\n\nconst Essentials = (props) => {\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const [currentAddress, setCurrentAddress] = useState(null);\n  const [currentState, setCurrentState] = useState(null);\n\n  const getLocation = () => {\n    navigator.geolocation.getCurrentPosition((position) => {\n      setCurrentLocation([position.coords.latitude, position.coords.longitude]);\n      getCurrentAddress(position.coords.latitude, position.coords.longitude);\n    });\n  };\n\n  const getCurrentAddress = (lat, lng) => {\n    try {\n      const base = 'https://api.bigdatacloud.net/data/reverse-geocode-client';\n      const url = `${base}?latitude=${lat}&longitude=${lng}&localityLanguage=en`;\n      fetch(url)\n        .then((response) => {\n          return response.json();\n        })\n        .then((data) => {\n          setCurrentAddress(data.locality);\n          setCurrentState(data.principalSubdivision);\n        });\n    } catch (err) {\n      console.log(err);\n      setCurrentAddress('Error fetching name of your location');\n      setCurrentState(null);\n    }\n  };\n\n  return (\n    <div className=\"Essentials\">\n      <img\n        src=\"/essentials_1.svg\"\n        alt=\"essentials platform\"\n        className=\"fadeInUp\"\n        style={{animationDelay: '0.3s'}}\n      />\n      <img\n        src=\"/essentials_2.svg\"\n        alt=\"essentials woman pushing cart\"\n        className=\"fadeInUp\"\n        style={{position: 'absolute', animationDelay: '0.1s'}}\n      />\n\n      {!currentLocation && (\n        <React.Fragment>\n          <button\n            className=\"button fadeInUp\"\n            style={{animationDelay: '0.6s'}}\n            onClick={() => getLocation()}\n          >\n            <span>View Nearby Essentials</span>\n            <Icon.Compass size={16} />\n          </button>\n          <div className=\"alert fadeInUp\" style={{animationDelay: '0.7s'}}>\n            <Icon.AlertOctagon size={16} />\n            <div className=\"alert-right is-full\">\n              {`We do not collect any location data; they're all stored \n              inside your browser and are inaccessible to us.`}\n            </div>\n          </div>\n          <div className=\"alert fadeInUp\" style={{animationDelay: '0.8s'}}>\n            <Icon.AlertOctagon size={16} />\n            <div className=\"alert-right is-full\">\n              {`We are a community sourced listing platform and are not associated\n              with any of the organizations listed below. Although we verify all\n              our listings, we request you to follow all the guidelines and take\n              the necessary precautions. We encourage you to report any error or\n              suspicious activity so that we can take immediate action.`}\n            </div>\n          </div>\n        </React.Fragment>\n      )}\n\n      {currentLocation && !currentAddress && <EssentialsLoader />}\n\n      {currentAddress && (\n        <div className=\"address fadeInUp\">\n          <h3>{currentAddress + ', ' + currentState}</h3>\n\n          <Icon.XCircle\n            size={16}\n            onClick={() => {\n              setCurrentLocation(null);\n              setCurrentAddress(null);\n              setCurrentState(null);\n            }}\n          />\n        </div>\n      )}\n\n      <div className=\"Search\">\n        {currentAddress && (\n          <KnnResults userLocation={currentLocation} userState={currentState} />\n        )}\n      </div>\n    </div>\n  );\n};\nexport default Essentials;\n"],"sourceRoot":""}