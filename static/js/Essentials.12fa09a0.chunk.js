(this.webpackJsonpcovid19india=this.webpackJsonpcovid19india||[]).push([[9],{306:function(e,t,a){"use strict";a.r(t);var r=a(62),n=a(71),s=a.n(n),i=a(77),c=a(215),l=a(216),o=a(6),u=a.n(o),d=a(221),p=a(222),m=a(167);function f(e){return e.properties.priority}function y(e){return!e.properties.priority}function h(e,t){var a=e[0]*Math.PI/180,r=t[0]*Math.PI/180,n=(t[1]-e[1])*Math.PI/180,s=6371e3*Math.acos(Math.sin(a)*Math.sin(r)+Math.cos(a)*Math.cos(r)*Math.cos(n));return Number((s/1e3).toFixed(2))}var v=function(e){var t=e.userLocation,a=e.userState,n=Object(o.useState)([]),v=Object(r.a)(n,2),E=v[0],g=v[1],N=Object(o.useState)(),b=Object(r.a)(N,2),j=b[0],w=b[1],O=Object(o.useState)([]),k=Object(r.a)(O,2),S=k[0],I=k[1];Object(m.a)((function(){x()}),[]);var x=Object(o.useCallback)((function(){fetch("https://api.covid19india.org/resources/geoResources.json").then((function(e){return e.json()})).then(g).catch((function(e){console.log(e)}))}),[]);return Object(o.useEffect)((function(){var e,r,n,s;t&&(e=new l(c.layer.geoJSON(E,{filter:f})).nearestLayer([t[1],t[0]],5),r=new l(c.layer.geoJSON(E,{filter:y})).nearestLayer([t[1],t[0]],100,1e4),n=null===E||void 0===E||null===(s=E.features)||void 0===s?void 0:s.filter((function(e){return"PAN India"===e.properties.state||e.properties.state.includes("PAN")&&e.properties.state.includes(a)})));var i={name:"NearestK-Essentials",type:"FeatureCollection",features:[]};if(e){var o=0;for(o=0;o<e.length;o++)i.features.push({type:"Feature",geometry:{type:"Point",coordinates:e[o].layer.feature.geometry.coordinates},properties:{name:e[o].layer.feature.properties.name,desc:e[o].layer.feature.properties.desc,addr:e[o].layer.feature.properties.addr,phone:e[o].layer.feature.properties.phone,contact:e[o].layer.feature.properties.contact,icon:e[o].layer.feature.properties.icon,recordid:e[o].layer.feature.properties.recordid,dist:h(t,e[o].layer.feature.geometry.coordinates.reverse())}})}if(r){var u=0;for(u=0;u<r.length;u++)i.features.push({type:"Feature",geometry:{type:"Point",coordinates:r[u].layer.feature.geometry.coordinates},properties:{name:r[u].layer.feature.properties.name,desc:r[u].layer.feature.properties.desc,addr:r[u].layer.feature.properties.addr,phone:r[u].layer.feature.properties.phone,contact:r[u].layer.feature.properties.contact,icon:r[u].layer.feature.properties.icon,recordid:r[u].layer.feature.properties.recordid,dist:h(t,r[u].layer.feature.geometry.coordinates.reverse())}})}if(n){var d=0;for(d=0;d<n.length;d++)i.features.push(n[d])}w(i)}),[E,t,a]),Object(o.useEffect)((function(){var e={};j&&j.features.map((function(e){var t;return null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.icon})).reduce((function(e,t){return e.set(t,(e.get(t)||0)+1)}),new Map).forEach((function(t,a,r){var n={count:t,isSelected:!0};e[a]=n})),I(e)}),[j]),j?u.a.createElement("div",{className:"results fadeInUp",style:{animationDelay:"0.5s"}},u.a.createElement("div",{className:"labels"},Object.keys(S).map((function(e){return u.a.createElement("div",{key:e,className:s()("label",{"is-selected":S[e].isSelected}),onClick:function(){return function(e,t){I(Object(i.a)((function(a){a[e].isSelected=t})))}(e,!S[e].isSelected)}},e,u.a.createElement("div",{className:"count"},S[e].count))}))),null===j||void 0===j?void 0:j.features.filter((function(e){return Object.keys(S).filter((function(e){return!0===S[e].isSelected})).includes(e.properties.icon)&&e.properties.dist})).map((function(e,t){return u.a.createElement("div",{key:e.properties.recordid?e.properties.recordid:t,className:"essential-result"},u.a.createElement("div",{className:"result-top"},u.a.createElement("div",{className:"result-top-left"},u.a.createElement("div",{className:"result-name"},e.properties.name),u.a.createElement("div",{className:"result-location"},e.properties.addr),e.properties.dist&&u.a.createElement("div",{className:"result-distance"},e.properties.dist+" km away")),u.a.createElement("a",{className:"result-category",href:e.properties.contact,target:"_noblank"},u.a.createElement("span",null,e.properties.icon),u.a.createElement(d.a,null))),u.a.createElement("div",{className:"result-description"},e.properties.desc),u.a.createElement("div",{className:"result-contacts"},e.properties.phone.split("\n").map((function(e){return u.a.createElement("div",{key:e,className:"result-contact"},u.a.createElement(p.a,null),u.a.createElement("a",{href:"tel:".concat(e)},e.replace(",","")))}))))})),u.a.createElement("div",null,u.a.createElement("h3",{className:"pan-divider"},"Throughout ".concat(a," and India"))),null===j||void 0===j?void 0:j.features.filter((function(e){return Object.keys(S).filter((function(e){return!0===S[e].isSelected})).includes(e.properties.icon)&&!e.properties.dist})).map((function(e,t){return u.a.createElement("div",{key:e.properties.recordid?e.properties.recordid:t,className:"essential-result"},u.a.createElement("div",{className:"result-top"},u.a.createElement("div",{className:"result-top-left"},u.a.createElement("div",{className:"result-name"},e.properties.name),u.a.createElement("div",{className:"result-location"},e.properties.addr),e.properties.dist&&u.a.createElement("div",{className:"result-distance"},e.properties.dist+" km away")),u.a.createElement("a",{className:"result-category",href:e.properties.contact,target:"_noblank"},u.a.createElement("span",null,e.properties.icon),u.a.createElement(d.a,null))),u.a.createElement("div",{className:"result-description"},e.properties.desc),u.a.createElement("div",{className:"result-contacts"},e.properties.phone.split("\n").map((function(e){return u.a.createElement("div",{key:e,className:"result-contact"},u.a.createElement(p.a,null),u.a.createElement("a",{href:"tel:".concat(e)},e.replace(",","")))}))))}))):null},E=a(88),g=a(214),N=a(271),b=a(186),j=a(157);function w(){var e=Object(j.a)(),t=Object(r.a)(e,2),a=t[0],n=t[1].width;return Object(o.useEffect)((function(){}),[n]),u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{ref:a,style:{width:"100%"}}),n&&u.a.createElement(E.a,{speed:1.5,width:n,height:325,viewBox:"0 0 ".concat(n," 325"),position:"absolute",className:"fadeInUp"},u.a.createElement("rect",{x:n/2-60,y:"10",rx:"5",ry:"5",width:"120",height:"32"}),u.a.createElement("rect",{x:n/2+70,y:"18",rx:"100",ry:"100",width:"15",height:"15"}),u.a.createElement("rect",{x:"10",y:"80",rx:"5",ry:"5",width:"85",height:"32"}),u.a.createElement("rect",{x:"100",y:"80",rx:"5",ry:"5",width:"65",height:"32"}),u.a.createElement("rect",{x:"10",y:"130",rx:"5",ry:"5",width:n-20,height:"172"})))}t.default=function(e){var t=Object(o.useState)(null),a=Object(r.a)(t,2),n=a[0],s=a[1],i=Object(o.useState)(null),c=Object(r.a)(i,2),l=c[0],d=c[1],p=Object(o.useState)(null),m=Object(r.a)(p,2),f=m[0],y=m[1],h=function(e,t){try{var a="".concat("https://api.bigdatacloud.net/data/reverse-geocode-client","?latitude=").concat(e,"&longitude=").concat(t,"&localityLanguage=en");fetch(a).then((function(e){return e.json()})).then((function(e){d(e.locality),y(e.principalSubdivision)}))}catch(r){console.log(r),d("Error fetching name of your location"),y(null)}};return u.a.createElement("div",{className:"Essentials"},u.a.createElement("img",{src:"/essentials_1.svg",alt:"essentials platform",className:"fadeInUp",style:{animationDelay:"0.3s"}}),u.a.createElement("img",{src:"/essentials_2.svg",alt:"essentials woman pushing cart",className:"fadeInUp",style:{position:"absolute",animationDelay:"0.1s"}}),!n&&u.a.createElement(u.a.Fragment,null,u.a.createElement("button",{className:"button fadeInUp",style:{animationDelay:"0.6s"},onClick:function(){navigator.geolocation.getCurrentPosition((function(e){s([e.coords.latitude,e.coords.longitude]),h(e.coords.latitude,e.coords.longitude)}))}},u.a.createElement("span",null,"View Nearby Essentials"),u.a.createElement(g.a,{size:16})),u.a.createElement("div",{className:"alert fadeInUp",style:{animationDelay:"0.7s"}},u.a.createElement(N.a,{size:16}),u.a.createElement("div",{className:"alert-right is-full"},"We do not collect any location data; they're all stored \n              inside your browser and are inaccessible to us.")),u.a.createElement("div",{className:"alert fadeInUp",style:{animationDelay:"0.8s"}},u.a.createElement(N.a,{size:16}),u.a.createElement("div",{className:"alert-right is-full"},"We are a community sourced listing platform and are not associated\n              with any of the organizations listed below. Although we verify all\n              our listings, we request you to follow all the guidelines and take\n              the necessary precautions. We encourage you to report any error or\n              suspicious activity so that we can take immediate action."))),n&&!l&&u.a.createElement(w,null),l&&u.a.createElement("div",{className:"address fadeInUp"},u.a.createElement("h3",null,l+", "+f),u.a.createElement(b.a,{size:16,onClick:function(){s(null),d(null),y(null)}})),u.a.createElement("div",{className:"Search"},l&&u.a.createElement(v,{userLocation:n,userState:f})))}}}]);
//# sourceMappingURL=Essentials.12fa09a0.chunk.js.map