{"version":3,"sources":["components/minigraph.js","../node_modules/classnames/index.js","../node_modules/fast-deep-equal/index.js"],"names":["React","memo","timeseries","timelineDate","date","refs","useRef","dates","useMemo","today","getIndiaYesterdayISO","pastDates","Object","keys","filter","cutOffDate","formatISO","subDays","parseIndiaDate","MINIGRAPH_LOOKBACK_DAYS","representation","useEffect","T","length","margin","chartRight","chartBottom","xScale","scaleTime","clamp","domain","range","dailyMin","min","getStatistic","dailyMax","max","Math","domainMinMax","yScale","scaleLinear","current","forEach","ref","index","pathLength","svg","select","statistic","PRIMARY_STATISTICS","color","COLORS","linePath","line","curve","curveMonotoneX","x","y","selectAll","data","join","enter","append","attr","this","getTotalLength","call","transition","delay","duration","update","attrTween","previous","interpolatePath","style","className","map","key","classnames","el","width","height","viewBox","preserveAspectRatio","prevProps","currProps","equal","stateCode","hasOwn","hasOwnProperty","classNames","classes","i","arguments","arg","argType","push","Array","isArray","inner","apply","module","exports","default","a","b","constructor","RegExp","source","flags","valueOf","prototype","toString"],"mappings":"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","file":"static/js/Minigraph.8d2122f0.chunk.js","sourcesContent":["import {\n  COLORS,\n  MINIGRAPH_LOOKBACK_DAYS,\n  PRIMARY_STATISTICS,\n} from '../constants';\nimport {\n  getStatistic,\n  getIndiaYesterdayISO,\n  parseIndiaDate,\n} from '../utils/commonfunctions';\n\nimport classnames from 'classnames';\nimport {min, max} from 'd3-array';\nimport {interpolatePath} from 'd3-interpolate-path';\nimport {scaleTime, scaleLinear} from 'd3-scale';\nimport {select} from 'd3-selection';\nimport {line, curveMonotoneX} from 'd3-shape';\n// eslint-disable-next-line\nimport {transition} from 'd3-transition';\nimport {formatISO, subDays} from 'date-fns';\nimport equal from 'fast-deep-equal';\nimport React, {useEffect, useRef, useMemo} from 'react';\n\nfunction Minigraph({timeseries, date: timelineDate}) {\n  const refs = useRef([]);\n\n  const dates = useMemo(() => {\n    const today = timelineDate || getIndiaYesterdayISO();\n    const pastDates = Object.keys(timeseries || {}).filter(\n      (date) => date <= today\n    );\n    const cutOffDate = formatISO(\n      subDays(parseIndiaDate(today), MINIGRAPH_LOOKBACK_DAYS),\n      {representation: 'date'}\n    );\n    return pastDates.filter((date) => date >= cutOffDate);\n  }, [timeseries, timelineDate]);\n\n  useEffect(() => {\n    const T = dates.length;\n\n    const margin = {top: 10, right: 5, bottom: 20, left: 5};\n    const chartRight = 100 - margin.right;\n    const chartBottom = 100 - margin.bottom;\n\n    const xScale = scaleTime()\n      .clamp(true)\n      .domain([parseIndiaDate(dates[0]), parseIndiaDate(dates[T - 1])])\n      .range([margin.left, chartRight]);\n\n    const dailyMin = min(dates, (date) =>\n      getStatistic(timeseries[date], 'delta', 'active')\n    );\n\n    const dailyMax = max(dates, (date) =>\n      Math.max(\n        getStatistic(timeseries[date], 'delta', 'confirmed'),\n        getStatistic(timeseries[date], 'delta', 'recovered'),\n        getStatistic(timeseries[date], 'delta', 'deceased')\n      )\n    );\n\n    const domainMinMax = Math.max(-dailyMin, dailyMax);\n\n    const yScale = scaleLinear()\n      .clamp(true)\n      .domain([-domainMinMax, domainMinMax])\n      .range([chartBottom, margin.top]);\n\n    refs.current.forEach((ref, index) => {\n      const svg = select(ref);\n      const statistic = PRIMARY_STATISTICS[index];\n      const color = COLORS[statistic];\n\n      const linePath = line()\n        .curve(curveMonotoneX)\n        .x((date) => xScale(parseIndiaDate(date)))\n        .y((date) =>\n          yScale(getStatistic(timeseries[date], 'delta', statistic))\n        );\n\n      let pathLength;\n      svg\n        .selectAll('path')\n        .data(T ? [dates] : [])\n        .join(\n          (enter) =>\n            enter\n              .append('path')\n              .attr('fill', 'none')\n              .attr('stroke', color + '99')\n              .attr('stroke-width', 2.5)\n              .attr('d', linePath)\n              .attr('stroke-dasharray', function () {\n                return (pathLength = this.getTotalLength());\n              })\n              .call((enter) =>\n                enter\n                  .attr('stroke-dashoffset', pathLength)\n                  .transition()\n                  .delay(100)\n                  .duration(2500)\n                  .attr('stroke-dashoffset', 0)\n              ),\n          (update) =>\n            update\n              .attr('stroke-dasharray', null)\n              .transition()\n              .duration(500)\n              .attrTween('d', function (date) {\n                const previous = select(this).attr('d');\n                const current = linePath(date);\n                return interpolatePath(previous, current);\n              })\n        );\n\n      svg\n        .selectAll('circle')\n        .data(T ? [dates[T - 1]] : [])\n        .join(\n          (enter) =>\n            enter\n              .append('circle')\n              .attr('fill', color)\n              .attr('r', 2.5)\n              .attr('cx', (date) => xScale(parseIndiaDate(date)))\n              .attr('cy', (date) =>\n                yScale(getStatistic(timeseries[date], 'delta', statistic))\n              )\n              .style('opacity', 0)\n              .call((enter) =>\n                enter\n                  .transition()\n                  .delay(2100)\n                  .duration(500)\n                  .style('opacity', 1)\n                  .attr('cx', (date) => xScale(parseIndiaDate(date)))\n                  .attr('cy', (date) =>\n                    yScale(getStatistic(timeseries[date], 'delta', statistic))\n                  )\n              ),\n          (update) =>\n            update\n              .transition()\n              .duration(500)\n              .attr('cx', (date) => xScale(parseIndiaDate(date)))\n              .attr('cy', (date) =>\n                yScale(getStatistic(timeseries[date], 'delta', statistic))\n              )\n        );\n    });\n  }, [dates, timeseries]);\n\n  return (\n    <div className=\"Minigraph\">\n      {PRIMARY_STATISTICS.map((statistic, index) => (\n        <div key={statistic} className={classnames('svg-parent')}>\n          <svg\n            ref={(el) => {\n              refs.current[index] = el;\n            }}\n            width=\"100\"\n            height=\"75\"\n            viewBox=\"0 0 100 75\"\n            preserveAspectRatio=\"xMidYMid meet\"\n          />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.stateCode, prevProps.stateCode)) {\n    return false;\n  } else if (!equal(currProps.date, prevProps.date)) {\n    return false;\n  }\n  return true;\n};\n\nexport default React.memo(Minigraph, isEqual);\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n"],"sourceRoot":""}